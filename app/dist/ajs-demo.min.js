/*! ajs-demo 2015-06-12 */
"use strict";angular.module("demoApp",["ngRoute","demoControllers","demoDirectives","karamControllers","ngCookies"]).config(["$routeProvider",function(a){a.when("/home",{templateUrl:"demo/home.html",controller:"HomeCtrl"}).when("/DeviceList",{templateUrl:"demo/device-list.html",controller:"DeviceList"}).when("/Http-test",{templateUrl:"demo/http-test.html",controller:"HttpCtrl"}).otherwise({redirectTo:"/home"})}]);var demoControllers=angular.module("demoControllers",[]);demoControllers.controller("HomeCtrl",["$scope","$cookies","$cookieStore","$http","$rootScope",function(a,b,c,d,e){a.userinfo=e.userinfo,a.karamValue=!0,a.token=b.token||c.get("token"),a.token&&d.jsonp(e.coxUrl+"/SSOServer/server/setCookie?callback=JSON_CALLBACK&token="+a.token).success(function(b){a.setScript(b.url)}).error(function(a){}),a.setScript=function(a){for(var b=document.createDocumentFragment(),c=document.getElementsByTagName("head")[0],d=0;d<a.length;d++){var e=document.createElement("script");e.type="text/javascript",e.src=a[d],b.appendChild(e)}c.appendChild(b)},a.setCookie=function(){var a={};a.userNickName="towersxu",c.put("userinfo",a)}}]),demoControllers.controller("DeviceList",["$scope","$http","$cookies","$rootScope",function(a,b,c,d){var e;a.token=c.token,a.userinfo=d.userinfo,a.davices=[],a.token&&(e=d.coxUrl+"/SSOServer/server/getBrowser?callback=JSON_CALLBACK&uid="+a.userinfo.userId,b.jsonp(e).success(function(b){a._setDevice(b)}).error(function(a){})),a._setDevice=function(b){a.davices=[];for(var c,d,e=/windows|linux/,f=/android|iphone/,g=/ie|chrome|trident|firefox/,h=/qq|micromessenger|bidu|uc/,i=0;i<b.length;i++)c={},c.agent=b[i].device,c.token=b[i].token,c.ip=b[i].ip,c.loginTime=b[i].logintime,c.region=b[i].region,d=c.agent.toLowerCase(),c.sys=d.match(e),c.sys?c.sys=c.sys[0]:c.sys="unknown",d.match(f)&&(c.sys=d.match(f)[0]),c.software=d.match(g),c.software?c.software=c.software[0]:c.software="unknown",d.match(h)&&(c.software=d.match(h)[0]),a.davices.push(c)},a.forceLogout=function(c,e,f,g,h){a.davices.splice(h,1);var i=d.coxUrl+"/SSOServer/server/otherlogout?callback=JSON_CALLBACK&device="+c+"&token="+e+"&ip="+f+"&logintime="+g;b.jsonp(i).success(function(b){a._setDevice(b)}).error(function(a){})}}]);var demoDirectives=angular.module("demoDirectives",[]);demoDirectives.directive("header",function(){return{templateUrl:"demo/header.html"}}),demoDirectives.controller("NavDirectiveCtrl",["$rootScope","$scope","$cookieStore","$cookies","$http","$window",function(a,b,c,d,e,f){a.coxUrl="http://192.168.1.36:8080";var g=c.get("userinfo")||d.userinfo||"{}";"object"==typeof g?a.userinfo=g:a.userinfo=JSON.parse(g),b.isHidden=!0,a.userinfo?(b.isHidden=!1,b.name=a.userinfo):b.isHidden=!0,b.logout=function(){var c=a.coxUrl+"/SSOServer/server/logout?callback=JSON_CALLBACK";b.isHidden=!0,e.jsonp(c).success(function(a){f.location.reload()}).error(function(a){})}}]);var karamControllers=angular.module("karamControllers",["ngResource"]);karamControllers.factory("jsonData",["$resource",function(a){return a("data/:url",{},{query:{method:"GET",params:{url:"urls"},isArray:!0}})}]),karamControllers.controller("HttpCtrl",["$scope","jsonData",function(a,b){a.data=b.get({url:"data.json"},function(a){}),console.log(a.data)}]);